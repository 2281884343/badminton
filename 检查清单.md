# âœ… éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼Œè¯·ç¡®ä¿å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼š

## ğŸ” å®‰å…¨æ£€æŸ¥

- [ ] å·²ä¿®æ”¹APIå¯†é’¥ï¼ˆä¸è¦ä½¿ç”¨ç¤ºä¾‹ä¸­çš„å¯†é’¥ï¼‰
  - ç¼–è¾‘ `backend/.env` æˆ– `backend/main.py`
  - è·å–ä½ è‡ªå·±çš„Moonshot APIå¯†é’¥

- [ ] å·²é…ç½®é˜²ç«å¢™è§„åˆ™
  ```bash
  sudo ufw enable
  sudo ufw allow 80/tcp
  sudo ufw allow 443/tcp
  sudo ufw allow 22/tcp
  ```

- [ ] å·²è®¾ç½®SSLè¯ä¹¦ï¼ˆå¦‚æœä½¿ç”¨HTTPSï¼‰
  ```bash
  sudo certbot --nginx -d your-domain.com
  ```

- [ ] å·²ä¿®æ”¹Nginxé…ç½®ä¸­çš„åŸŸå/IP
  - ç¼–è¾‘ `nginx.conf`
  - ä¿®æ”¹ `server_name` ä¸ºä½ çš„åŸŸå

- [ ] å·²æ£€æŸ¥æ–‡ä»¶æƒé™
  ```bash
  chmod 755 deploy.sh start-dev.sh start-prod.sh
  chmod 644 badminton-game.service nginx.conf
  ```

## ğŸš€ ç¯å¢ƒæ£€æŸ¥

- [ ] Pythonç‰ˆæœ¬ â‰¥ 3.8
  ```bash
  python3 --version
  ```

- [ ] Node.jsç‰ˆæœ¬ â‰¥ 16
  ```bash
  node --version
  ```

- [ ] å·²å®‰è£…å¿…è¦çš„ç³»ç»ŸåŒ…
  ```bash
  # Ubuntu/Debian
  sudo apt install python3-venv nginx
  ```

- [ ] ç£ç›˜ç©ºé—´å……è¶³ï¼ˆå»ºè®® â‰¥ 2GBå¯ç”¨ç©ºé—´ï¼‰
  ```bash
  df -h
  ```

- [ ] å†…å­˜å……è¶³ï¼ˆå»ºè®® â‰¥ 1GBå¯ç”¨å†…å­˜ï¼‰
  ```bash
  free -h
  ```

## ğŸ“ æ–‡ä»¶é…ç½®æ£€æŸ¥

- [ ] å·²ä¿®æ”¹ `badminton-game.service` ä¸­çš„è·¯å¾„
  - `WorkingDirectory=/path/to/bm/backend`
  - `Environment="PATH=/path/to/bm/backend/venv/bin"`
  - `ExecStart=/path/to/bm/backend/venv/bin/python main.py`
  - `User=your-username`

- [ ] å·²ä¿®æ”¹ `nginx.conf` ä¸­çš„è·¯å¾„
  - `server_name your-domain.com`
  - `root /path/to/bm/frontend/dist`

- [ ] åˆ›å»ºäº†æ•°æ®ç›®å½•
  ```bash
  mkdir -p backend/data/players
  ```

## ğŸ”¨ æ„å»ºå’Œä¾èµ–

- [ ] åç«¯ä¾èµ–å·²å®‰è£…
  ```bash
  cd backend
  source venv/bin/activate
  pip list
  ```

- [ ] å‰ç«¯ä¾èµ–å·²å®‰è£…
  ```bash
  cd frontend
  ls node_modules/ | wc -l  # åº”è¯¥æœ‰å¾ˆå¤šæ–‡ä»¶
  ```

- [ ] å‰ç«¯å·²æ„å»ºï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
  ```bash
  cd frontend
  ls -la dist/  # åº”è¯¥æœ‰index.htmlå’Œassets/
  ```

## ğŸŒ ç½‘ç»œæ£€æŸ¥

- [ ] åç«¯ç«¯å£8080å¯è®¿é—®
  ```bash
  curl http://localhost:8080/api/skills
  ```

- [ ] å‰ç«¯ç«¯å£3000å¯è®¿é—®ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
  ```bash
  curl http://localhost:3000
  ```

- [ ] WebSocketè¿æ¥æ­£å¸¸
  ```bash
  # åœ¨æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•
  # ws = new WebSocket("ws://localhost:8080/ws/test/testuser")
  ```

- [ ] APIå¯†é’¥æœ‰æ•ˆ
  ```bash
  curl -X POST https://api.moonshot.cn/v1/chat/completions \
    -H "Authorization: Bearer YOUR_API_KEY" \
    -H "Content-Type: application/json" \
    -d '{"model": "kimi-k2-turbo-preview", "messages": [{"role": "user", "content": "test"}]}'
  ```

## ğŸ”„ æœåŠ¡çŠ¶æ€æ£€æŸ¥

- [ ] NginxæœåŠ¡æ­£å¸¸
  ```bash
  sudo systemctl status nginx
  sudo nginx -t
  ```

- [ ] åç«¯æœåŠ¡æ­£å¸¸
  ```bash
  sudo systemctl status badminton-game
  ```

- [ ] æœåŠ¡è‡ªåŠ¨å¯åŠ¨å·²å¯ç”¨
  ```bash
  sudo systemctl is-enabled badminton-game
  sudo systemctl is-enabled nginx
  ```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

- [ ] èƒ½å¤ŸæŸ¥çœ‹åç«¯æ—¥å¿—
  ```bash
  sudo journalctl -u badminton-game -f
  ```

- [ ] èƒ½å¤ŸæŸ¥çœ‹Nginxæ—¥å¿—
  ```bash
  sudo tail -f /var/log/nginx/access.log
  sudo tail -f /var/log/nginx/error.log
  ```

- [ ] å·²è®¾ç½®æ—¥å¿—è½®è½¬ï¼ˆå¯é€‰ï¼‰
  ```bash
  ls /etc/logrotate.d/nginx
  ```

## ğŸ’¾ å¤‡ä»½æ£€æŸ¥

- [ ] å·²è®¾ç½®æ•°æ®å¤‡ä»½è®¡åˆ’
  ```bash
  crontab -l  # æŸ¥çœ‹æ˜¯å¦æœ‰å¤‡ä»½ä»»åŠ¡
  ```

- [ ] æµ‹è¯•å¤‡ä»½æ¢å¤æµç¨‹
  ```bash
  cp -r backend/data/players /tmp/test-backup
  ```

## ğŸ§ª åŠŸèƒ½æµ‹è¯•

- [ ] åˆ›å»ºæµ‹è¯•ç”¨æˆ·æˆåŠŸ
- [ ] ä¿å­˜æŠ€èƒ½é…ç½®æˆåŠŸ
- [ ] åˆ›å»ºæˆ¿é—´æˆåŠŸ
- [ ] åŠ å…¥æˆ¿é—´æˆåŠŸ
- [ ] WebSocketè¿æ¥æˆåŠŸ
- [ ] å‘é€å‡»çƒåŠ¨ä½œæˆåŠŸ
- [ ] AIæè¿°ç”ŸæˆæˆåŠŸ
- [ ] æ¯”åˆ†è®¡ç®—æ­£ç¡®
- [ ] æ¸¸æˆç»“æŸåˆ¤å®šæ­£ç¡®

## ğŸ¯ æ€§èƒ½æµ‹è¯•

- [ ] å•ç”¨æˆ·å“åº”æ—¶é—´ < 1ç§’
- [ ] å¤šç”¨æˆ·åŒæ—¶åœ¨çº¿æµ‹è¯•ï¼ˆå»ºè®®æµ‹è¯•10+ç”¨æˆ·ï¼‰
- [ ] é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§æµ‹è¯•ï¼ˆå»ºè®®è¿è¡Œ24å°æ—¶ï¼‰
- [ ] å†…å­˜ä½¿ç”¨æ­£å¸¸ï¼ˆä¸æŒç»­å¢é•¿ï¼‰
- [ ] CPUä½¿ç”¨ç‡æ­£å¸¸ï¼ˆ< 80%ï¼‰

## ğŸ“± æµè§ˆå™¨å…¼å®¹æ€§

- [ ] Chromeæµè§ˆå™¨æµ‹è¯•é€šè¿‡
- [ ] Firefoxæµè§ˆå™¨æµ‹è¯•é€šè¿‡
- [ ] Safariæµè§ˆå™¨æµ‹è¯•é€šè¿‡ï¼ˆå¦‚æœæœ‰Macï¼‰
- [ ] ç§»åŠ¨ç«¯æµè§ˆå™¨æµ‹è¯•é€šè¿‡

## ğŸ”§ æ•…éšœæ¢å¤

- [ ] çŸ¥é“å¦‚ä½•é‡å¯æœåŠ¡
  ```bash
  sudo systemctl restart badminton-game
  sudo systemctl restart nginx
  ```

- [ ] çŸ¥é“å¦‚ä½•æŸ¥çœ‹æ—¥å¿—
  ```bash
  sudo journalctl -u badminton-game -n 100
  ```

- [ ] çŸ¥é“å¦‚ä½•å›æ»šæ›´æ–°
  ```bash
  git checkout <previous-commit>
  ./deploy.sh
  ```

- [ ] æœ‰ç´§æ€¥è”ç³»æ–¹å¼å’Œå¤‡ç”¨æ–¹æ¡ˆ

## ğŸ“ æ–‡æ¡£æ£€æŸ¥

- [ ] å·²è®°å½•æœåŠ¡å™¨é…ç½®ä¿¡æ¯
  - æœåŠ¡å™¨IP/åŸŸå
  - SSHç™»å½•ä¿¡æ¯
  - å„æœåŠ¡ç«¯å£
  - APIå¯†é’¥ä¿å­˜ä½ç½®

- [ ] å·²åˆ›å»ºæ“ä½œæ‰‹å†Œç»™å…¶ä»–ç®¡ç†å‘˜

- [ ] å·²è®°å½•å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

## æœ€åç¡®è®¤

- [ ] æ‰€æœ‰å¿…éœ€çš„æ£€æŸ¥é¡¹éƒ½å·²å®Œæˆ âœ“
- [ ] å·²åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯è¿‡ âœ“
- [ ] å·²å‡†å¤‡å¥½ç›‘æ§å’Œæ—¥å¿—å·¥å…· âœ“
- [ ] å·²é€šçŸ¥ç›¸å…³äººå‘˜éƒ¨ç½²è®¡åˆ’ âœ“
- [ ] å·²å‡†å¤‡å¥½å›æ»šæ–¹æ¡ˆ âœ“

---

**æ£€æŸ¥å®Œæˆåå³å¯éƒ¨ç½²ï¼ğŸš€**

éƒ¨ç½²å‘½ä»¤ï¼š
```bash
./deploy.sh
./start-prod.sh
# æˆ–
sudo systemctl start badminton-game
```

ç¥éƒ¨ç½²é¡ºåˆ©ï¼å¦‚é‡é—®é¢˜è¯·æŸ¥çœ‹ [éƒ¨ç½²æŒ‡å—-Linux.md](./éƒ¨ç½²æŒ‡å—-Linux.md)

